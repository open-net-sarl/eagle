<?xml version="1.0"?>
<!--
  File: contracts_view.xml
  Module: eagle_management

  Created by cyp@open-net.ch

  Copyright (c) 2011 Open-Net Ltd. All rights reserved.
-->
<openerp>
	<data>

        <!--
			Inherited contract form view from the Eagle Base module 
    	-->
		<record model="ir.ui.view" id="eagle_management_view_contract_form">
			<field name="name">Eagle Management Contract View</field>
			<field name="model">eagle.contract</field>
			<field name="inherit_id" ref="eagle_base.eagle_view_contract_form"/>
			<field name="arch" type="xml">
                <group name="top" position="inside">
					<field name="tab_profile_cur_sol" invisible="1"/>
					<field name="tab_profile_old_sol" invisible="1"/>
					<field name="tab_profile_purchases" invisible="1"/>
					<field name="tab_profile_invoices" invisible="1"/>
					<field name="tab_profile_procurements" invisible="1"/>
					<field name="tab_profile_manufacturing" invisible="1"/>
					<field name="tab_profile_moves" invisible="1"/>
					<field name="tab_profile_incoming_prods" invisible="1"/>
					<field name="tab_profile_outgoing_prods" invisible="1"/>
					<field name="eagle_make_sale_button_visible" invisible="1"/>
				</group>
				<page string="Content" position="after">
					<page string="Current Sale Order Lines" attrs="{'invisible':[('tab_profile_cur_sol','=',False),('eagle_parm_show_all_meta_tabs','=',False)]}">
						<field name="current_sale_order_lines">
			                <tree string="Sales Order Lines">
			                    <field name="order_id"/>
			                    <field name="order_partner_id"/>
			                    <field name="name"/>
			                    <field name="product_uom_qty" string="Qty"/>
			                    <field name="product_uom" string="UoM"/>
			                    <field name="salesman_id"/>
			                    <field name="price_subtotal" sum="Total"/>
			                    <field name="state"/>
			                    <field name="invoiced"/>
			                </tree>
			                <!-- Use default form view -->
						</field>
					</page>
					<page string="Past Sale Order Lines" attrs="{'invisible':[('tab_profile_old_sol','=',False),('eagle_parm_show_all_meta_tabs','=',False)]}">
						<field name="past_sale_order_lines">
			                <tree string="Sales Order Lines">
			                    <field name="order_id"/>
			                    <field name="order_partner_id"/>
			                    <field name="name"/>
			                    <field name="product_uom_qty" string="Qty"/>
			                    <field name="product_uom" string="UoM"/>
			                    <field name="salesman_id"/>
			                    <field name="price_subtotal" sum="Total"/>
			                    <field name="state"/>
			                    <field name="invoiced"/>
			                </tree>
			                <!-- Use default form view -->
						</field>
					</page>
					<page string="Purchases" attrs="{'invisible':[('tab_profile_purchases','=',False),('eagle_parm_show_all_meta_tabs','=',False)]}">
						<field name="purchase_orders"/>
					</page>
					<page string="Invoices" attrs="{'invisible':[('tab_profile_invoices','=',False),('eagle_parm_show_all_meta_tabs','=',False)]}">
						<field name="account_invoices">
							<tree colors="blue:state in ('draft');black:state in ('proforma','proforma2','open');gray:state in ('cancel')" string="Invoice">
								<field name="date_invoice"/>
								<field name="number"/>
								<field name="partner_id" groups="base.group_user"/>
								<field name="name"/>
								<field name="journal_id" invisible="1"/>
								<field name="period_id" invisible="1" groups="account.group_account_user"/>
								<field name="company_id" groups="base.group_multi_company" widget="selection"/>
								<field name="user_id"/>
								<field name="date_due"/>
								<field name="origin"/>
								<field name="currency_id"/>
								<field name="residual" sum="Residual Amount"/>
								<field name="amount_untaxed" sum="Untaxed Amount"/>
								<field name="amount_total" sum="Total Amount"/>
								<field name="state"/>
								
								<button name="invoice_open" states="draft,proforma2" string="Approve" icon="terp-camera_test"/>
							</tree>
                            <!-- Default form -->
						</field>
					</page>
				</page>
				<page string="Other infos" position="before">
					<page string="Procurements" attrs="{'invisible':[('tab_profile_procurements','=',False),('eagle_parm_show_all_meta_tabs','=',False)]}">
						<field name="procurement_orders"/>
					</page>
					<page string="Manufacturing" attrs="{'invisible':[('tab_profile_manufacturing','=',False),('eagle_parm_show_all_meta_tabs','=',False)]}">
						<field name="production_orders"/>
					</page>
					<page string="Moves" attrs="{'invisible':[('tab_profile_moves','=',False),('eagle_parm_show_all_meta_tabs','=',False)]}">
						<field name="stock_moves"/>
					</page>
					<page string="Incoming products" attrs="{'invisible':[('tab_profile_incoming_prods','=',False),('eagle_parm_show_all_meta_tabs','=',False)]}">
						<field name="stock_pickings_in"/>
					</page>
					<page string="Outgoing products" attrs="{'invisible':[('tab_profile_outgoing_prods','=',False),('eagle_parm_show_all_meta_tabs','=',False)]}">
						<field name="stock_pickings_out"/>
					</page>
				</page>
                <div name="base_buttons" position="inside">
					<button name="button_make_sale" string="Make Sale" type="object" class="oe_right" attrs="{'invisible':['|',('eagle_make_sale_button_visible','=',False),('state','not in',['installation','production'])]}"/>
				</div>
                <xpath expr="//group[@string='Classification']" position="inside">
					<field name="shop_id"/>
				</xpath>
			</field>
		</record>
		<record model="ir.ui.view" id="eagle_management_view_contract_position_form">
			<field name="name">Eagle Management Contract Position View</field>
			<field name="model">eagle.contract.position</field>
			<field name="inherit_id" ref="eagle_base.eagle_view_contract_pos_form"/>
			<field name="arch" type="xml">
				<page string="Informations" position="after">
					<page string="Dates management">
						<group name="dt_mgt_left" colspan="2" col="2">
							<field name="cust_delivery_date" string="Customer Delivery" attrs="{'readonly':[('state','=','done')]}" colspan="2"/>
							<field name="stock_disposal_date" string="Stock Disposal" attrs="{'readonly':[('state','=','done')]}" on_change="recomp_start_date(stock_disposal_date,product_duration)" colspan="2"/>
							<field name="product_duration" attrs="{'readonly':[('state','=','done')]}" on_change="recomp_start_date(stock_disposal_date,product_duration)" colspan="2"/>
							<field name="cl_start_date" colspan="2"/>
						</group>
						<group name="dt_mgt_right" colspan="2" col="2">
							<newline/>
						</group>
					</page>
				</page>
			</field>
		</record>

	</data>
</openerp>
